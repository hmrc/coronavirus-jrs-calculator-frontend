@*
 * Copyright 2020 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *@

@import controllers.routes._
@import models.FurloughTopUpStatus

@this(
        govukLayout: templates.GovukLayoutWrapper,
        formHelper: FormWithCSRF,
        errorSummary: components.errorSummary,
        inputRadio: components.inputRadio,
        button: components.button,
        h1: components.h1,
        h2: components.h2,
        p: components.p
)

@(form: Form[_], calculationResult: CalculationResult)(implicit request: Request[_], messages: Messages)

@govukLayout(pageTitle = Some(title(form, "furloughTopUp.title"))) {

    @formHelper(action = FurloughTopUpController.onSubmit(), 'autoComplete -> "off", 'novalidate -> "novalidate") {

        @errorSummary(form.errors)

        @h1("furloughTopUp.heading")

        <table class="govuk-table review-authorisations govuk-!-margin-bottom-7">
            <tbody class="govuk-table__body">
                <tr class="govuk-table__row">

                    <th class="govuk-table__header">
                        @messages("furloughTopUp.payperiodending.label")
                    </th>
                    <th class="govuk-table__header">
                        <span class="govuk-!-font-weight-bold">@messages("furloughTopUp.grossfurloughamount.label")</span>
                    </th>

                </tr>

                @calculationResult.payPeriodBreakdowns.map { periodBreakdown =>
                    <tr class="govuk-table__row">
                        <td class="govuk-table__cell">@dateToString(periodBreakdown.periodWithPaymentDate.period.period.end)</td>
                        <td class="govuk-table__cell">
                        £@periodBreakdown.grant.value.setScale(2)
                        </td>
                    </tr>
                }

                <tr class="govuk-table__row" style="border-top: 5px solid #b1b4b6">
                    <td class="govuk-table__cell" style="border-bottom:0"><span class="govuk-!-font-weight-bold">@messages("furloughTopUp.total.label")</span></td>
                    <td class="govuk-table__cell" style="border-bottom:0">
                        <span class="govuk-!-font-weight-bold"> £@calculationResult.total.setScale(2) </span>
                    </td>
                </tr>
            </tbody>
        </table>

        @h2("furloughTopUp.p1", classes = Some("govuk-heading-m govuk-!-margin-bottom-1"))

        @p(Html(messages("furloughTopUp.p2")))

        @p(Html(messages("furloughTopUp.p3")))

        @inputRadio(
            form = form,
            legend = messages("furloughTopUp.p1"),
            legendAsHeading = false,
            classes = "govuk-visually-hidden",
            items = FurloughTopUpStatus.options(form)
        )

        @button("site.continue")
    }
}
